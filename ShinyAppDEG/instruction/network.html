<!DOCTYPE html>
<html>
<body>

<div align="justify">

<p>This section applies network analysis on the subsetted matrix in the Matrix Heatmap with WGCNA (Langfelder and Horvath 2008). Briefly, a correlation matrix or distance matrix is computed on all genes in Matrix Heatmap, and transformed to an adjacency matrix and topological overlap matrix (TOM) sequentially, which are advanced measures to quantify coexpression similarity. Then network modules are identified by hierarchinally clustering the TOM-transformed dissimilarity matrix 1-TOM, which are clusters of genes with highly similar coexpression profiles. The module containing a target gene is finally displayed as interactive network graph. Since this is a coexpression analysis, variables of sample/condition should be at least 5. Otherwise, resulting modules are not reliable. Refer to <a href='https://jianhaizhang.github.io/SVG_tutorial_file/spatialHeatmap.html' target="_blank">package vignette</a> for details. </p>

<b>Color scheme:</b> In the network, nodes and edges are genes and adjacency between genes respectively. There is an interactive color bar to denote gene connectivity (sum of a gene's adjacency with all its direct neighbours). The separaters in color ingredients could be comma, semicolon, single space, dot, hypen, underscore, or forward slash, and backward slash is not allowed, <em>e.g.</em> the default are "yellow,orange,red", which means gene connectivity increases from yellow to red.<br/>
<b>Minmum module size:</b> Expected minimum module size in gene module identification.<br/>
<b>Network type:</b> Transformation of correlation and distance measure. For "unsigned", adjacency = |cor|^power; for "signed", adjacency = (0.5 * (1+cor) )^power; for "signed hybrid", adjacency = cor^power if cor>0 and 0 otherwise; and for "distance", adjacency = (1-(dist/max(dist))^2)^power, where power is 1 for "distance" and 6 otherwise. <br/>
<b>Select a target gene:</b> All gene IDs chosen in Data Matrix are listed here. Once a gene is selected in this list, the network modules are identified at two alternative sensitivity levels (ds=2 or 3). The selected gene ID is appended "_target" in the graph for easy identification. <br/>
<b>Module splitting sensitivity level:</b> From 2 to 3, the sensitivity increases and results in more modules with smaller sizes.<br/>
<b>Adjacency threshold/Maximun edges:</b> By default, only top edges are shown, since too many edges might crash the session. To display more edges, the adjcency threshold should be decreased gradually. The "Maximun edges" limits the total of shown edges. In case a very low adjacency threshold is choosen and introduces too many edges that exceed the Maximun edges, the app will internally increase the adjacency threshold until the edge total is within the Maximun edges, which is a protection against too many edges. The adjacency threshold of 1 produces no edges, in this case the app wil internally decrease this threshold until the number of edges reaches the Maximun edges. If adjacency threshold of 0.998 is selected and no edge is left, this app will also internally update the edges to 1 or 2.
<br/>

<b>Update:</b> Every time when selected genes changed in the Data Matrix, the network graph is not updated automatically. Otherwise the internal network computation would slow down the app, especially when many genes are selected in a short time. Once the final target genes are selected, simply click this button and the latest network will be shown. <br/>

<div>

</body>
</html>







